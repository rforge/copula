
R version 2.8.1 (2008-12-22)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(copula, lib.loc="../../../../copula.Rcheck")
Loading required package: mvtnorm
Loading required package: scatterplot3d
Loading required package: sn
Loading required package: mnormt
Loading required package: adapt
Loading required package: pspline
> source("../../../R/claytonExpr.R")
> source("../../../R/gumbelExpr.R")
> source("../../../R/frankExpr.R")
> source("../../../R/plackettExpr.R")
> 
> source("../../../R/E.R")
> 
> source("../../../R/derCdfPdf.R")
> 
> 
> set.seed(1234)
> 
> #### clayton
> cop <- claytonCopula(2, dim=5)
> u <- rcopula(cop, 10)
> 
> derCdfWrtParams(cop, u)
             [,1]
 [1,] 0.013526393
 [2,] 0.062175343
 [3,] 0.047666939
 [4,] 0.007237582
 [5,] 0.015748115
 [6,] 0.062139896
 [7,] 0.034163668
 [8,] 0.049415945
 [9,] 0.029426260
[10,] 0.021846054
> derCdfWrtArgs(cop, u)
            [,1]       [,2]       [,3]        [,4]       [,5]
 [1,] 0.28191465 0.01996816 0.10896715 0.061738259 0.04059750
 [2,] 0.08040770 0.10078695 0.20773807 0.235125577 0.07485828
 [3,] 0.03377119 0.11066733 0.18522678 0.101951804 0.09929455
 [4,] 0.03004505 0.00220096 0.52872789 0.051515345 0.03028246
 [5,] 0.00471597 0.10085824 0.13815085 0.164525948 0.08652685
 [6,] 0.18585883 0.08403742 0.09488014 0.117868738 0.29894787
 [7,] 0.41077716 0.06434460 0.02727007 0.090192055 0.01524013
 [8,] 0.33160358 0.31050418 0.14376252 0.315142963 0.22436906
 [9,] 0.04314232 0.31493022 0.01610717 0.002123774 0.24493016
[10,] 0.04282539 0.13352165 0.40217527 0.009116075 0.01218206
> derPdfWrtParams(cop, u)
             [,1]
 [1,] 630.8823992
 [2,]   2.6610102
 [3,]  13.5527624
 [4,] -96.5419223
 [5,] 196.5257373
 [6,]   2.0675057
 [7,]  -0.2859451
 [8,]   5.5533122
 [9,]  -0.5317332
[10,]  -2.5713319
> derPdfWrtArgs(cop, u)
              [,1]         [,2]         [,3]         [,4]         [,5]
 [1,] 18793.168260 -9848.434767 -3882.643627 -8395.477571 -9686.901062
 [2,]    -6.752198    -4.729920     8.364676    12.089571    -7.254740
 [3,]   -48.597539   -18.114850    26.596402   -22.747155   -24.123848
 [4,] -1958.178663 -1190.319465 11024.863319 -1787.298541 -1957.653617
 [5,] -2285.860175 -1453.992110  -158.060568   840.559388 -1900.291156
 [6,]     4.786875    -5.611170    -4.674736    -2.510926    18.468889
 [7,]    60.463519   -13.061527   -15.932467    -9.333643   -15.222514
 [8,]    44.611402    39.299357     0.278481    40.462377    18.317101
 [9,]    -2.490114     6.135291    -2.502381    -1.561705     3.523043
[10,]   -44.875279    -5.011152   171.390982   -40.834210   -43.150618
> 
> #### gumbel
> cop <- gumbelCopula(2, dim=5)
> u <- rcopula(cop, 10)
> 
> derCdfWrtParams(cop, u)
             [,1]
 [1,] 0.029892410
 [2,] 0.016976942
 [3,] 0.027111779
 [4,] 0.066154650
 [5,] 0.005693768
 [6,] 0.017892100
 [7,] 0.033058173
 [8,] 0.079151836
 [9,] 0.123317038
[10,] 0.101448112
> derCdfWrtArgs(cop, u)
              [,1]        [,2]        [,3]        [,4]        [,5]
 [1,] 0.2370112408 0.046691690 0.028607615 0.002273527 0.072428646
 [2,] 0.0118734772 0.139085503 0.007038094 0.038732773 0.042991350
 [3,] 0.0243509943 0.003847392 0.073369918 0.096658804 0.100810512
 [4,] 0.0298994717 0.115108965 0.010275029 0.437698616 0.139195710
 [5,] 0.0001024041 0.044092174 0.013923669 0.067598099 0.008630644
 [6,] 0.0031304460 0.060930869 0.047251966 0.007563820 0.161896787
 [7,] 0.0346134880 0.005345374 0.053032896 0.083546948 0.188700582
 [8,] 0.3031401963 0.170062631 0.104323065 0.007941018 0.101060031
 [9,] 0.4711372884 0.075373103 0.152305774 0.218514516 0.316867291
[10,] 0.1955860102 0.159168220 0.170889630 0.005393244 0.592712641
> derPdfWrtParams(cop, u)
             [,1]
 [1,] -1.01324958
 [2,]  5.95788796
 [3,]  0.44053448
 [4,] -0.69419102
 [5,] -2.81511843
 [6,] -1.18637821
 [7,]  0.03488917
 [8,] -0.53444767
 [9,]  3.16597448
[10,] -0.73378820
> derPdfWrtArgs(cop, u)
              [,1]        [,2]        [,3]       [,4]         [,5]
 [1,]   8.78103420  -2.3933408  -3.1678527  -6.728648  -1.15739264
 [2,] -37.61801401  53.3751652 -38.1773427 -27.615135 -25.18954103
 [3,] -11.18862995 -15.9038907  -3.1264147   1.574482   2.45174752
 [4,]  -1.80375655  -0.2946323  -3.3973179   4.076205   0.03193715
 [5,] -17.17429233  -7.1023409 -12.7505447   1.370096 -12.27575072
 [6,] -11.75500372  -3.9818966  -6.3109463 -10.674907  18.41590374
 [7,]  -7.55964480 -12.5706948  -5.4672987  -1.590664  14.17346160
 [8,]   4.34775801   0.8608002  -0.8763244  -7.982399  -0.96557136
 [9,]  38.07849189 -33.2447236 -10.6579031   1.476967  16.58334285
[10,]  -0.02483875  -0.3590666  -0.2472502 -15.683990   2.91843577
> 
> 
> #### frank
> cop <- frankCopula(2, dim=5)
> u <- rcopula(cop, 10)
> 
> derCdfWrtParams(cop, u)
             [,1]
 [1,] 0.043015506
 [2,] 0.020117662
 [3,] 0.055442933
 [4,] 0.008929879
 [5,] 0.024842157
 [6,] 0.003199121
 [7,] 0.006934333
 [8,] 0.023148240
 [9,] 0.021298992
[10,] 0.037943287
> derCdfWrtArgs(cop, u)
             [,1]        [,2]        [,3]        [,4]       [,5]
 [1,] 0.300700720 0.178229901 0.061952175 0.227282031 0.13118316
 [2,] 0.327735137 0.064864118 0.094169232 0.020173581 0.04190159
 [3,] 0.266169435 0.200200222 0.192817618 0.227206769 0.29638779
 [4,] 0.034637326 0.005747572 0.021117581 0.042307438 0.19748441
 [5,] 0.037141717 0.129585440 0.069669719 0.103158372 0.08180066
 [6,] 0.162666630 0.003544180 0.005798055 0.006020961 0.02810898
 [7,] 0.005748938 0.011720999 0.032818434 0.028517795 0.20993882
 [8,] 0.640216237 0.068854083 0.080254861 0.056776265 0.12049460
 [9,] 0.039605651 0.040827241 0.292165117 0.085855012 0.04678422
[10,] 0.100995321 0.078054554 0.182121446 0.084833255 0.22049944
> derPdfWrtParams(cop, u)
             [,1]
 [1,]  0.11920464
 [2,] -0.17503520
 [3,]  1.25807725
 [4,] -0.21397647
 [5,]  0.39531528
 [6,] -0.27908196
 [7,] -0.23527142
 [8,] -0.30610800
 [9,] -0.06797052
[10,]  0.33710585
> derPdfWrtArgs(cop, u)
            [,1]       [,2]        [,3]       [,4]        [,5]
 [1,]  3.2916337  0.8921464 -1.38600385  1.8531914 -0.02960829
 [2,]  2.4592448 -0.3475985 -0.03468891 -0.8247882 -0.59278420
 [3,]  4.6351001  1.9968142  1.70156406  3.0768785  5.84361338
 [4,] -0.6017382 -1.0218611 -0.79834613 -0.4901973  1.76642994
 [5,] -1.6648424  1.0492368 -0.70984433  0.2733577 -0.35368876
 [6,]  1.7596971 -1.1737983 -1.13224708 -1.1281377 -0.72093496
 [7,] -1.0030873 -0.9142252 -0.60030335 -0.6642952  2.03518129
 [8,]  3.9067846 -0.4410488 -0.35429350 -0.5329561 -0.04808547
 [9,] -0.9085587 -0.8885725  3.22351343 -0.1518827 -0.79111158
[10,] -0.3304510 -0.8565336  1.52995066 -0.7010830  2.41004313
> 
> #### plackett
> cop <- plackettCopula(2) # dim = 2 only
> u <- rcopula(cop, 10)
> 
> derCdfWrtParams(cop, u)
             [,1]
 [1,] 0.030307764
 [2,] 0.001271254
 [3,] 0.019378596
 [4,] 0.022177928
 [5,] 0.008036380
 [6,] 0.016372860
 [7,] 0.002375148
 [8,] 0.020437550
 [9,] 0.016180191
[10,] 0.025372936
> derCdfWrtArgs(cop, u)
           [,1]      [,2]
 [1,] 0.4895184 0.5119032
 [2,] 0.9897099 0.3318252
 [3,] 0.4241092 0.8025128
 [4,] 0.2444030 0.6461212
 [5,] 0.2171347 0.1571550
 [6,] 0.6891175 0.7539286
 [7,] 0.9802127 0.4025564
 [8,] 0.4770330 0.2289018
 [9,] 0.7735236 0.6651416
[10,] 0.5743129 0.2954758
> derPdfWrtParams(cop, u)
              [,1]
 [1,]  0.088023872
 [2,] -0.143461576
 [3,]  0.007455412
 [4,] -0.015023212
 [5,]  0.311416357
 [6,]  0.179874575
 [7,] -0.085590482
 [8,]  0.077666454
 [9,]  0.170770158
[10,]  0.039940171
> derPdfWrtArgs(cop, u)
             [,1]        [,2]
 [1,] -0.03737915  0.04093142
 [2,]  1.16303413 -0.59097373
 [3,] -0.36101819  0.88552271
 [4,] -0.72880924  0.49677022
 [5,] -1.16981339 -1.51005657
 [6,]  0.59097986  0.88416909
 [7,]  1.32699527 -0.49480976
 [8,]  0.06945408 -0.85715552
 [9,]  0.96363674  0.47867928
[10,]  0.31144423 -0.61822264
> 
> proc.time()
   user  system elapsed 
  1.749   0.033   1.777 
